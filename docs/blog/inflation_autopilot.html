<!DOCTYPE html>
<html lang="en" data-accent-color="violet" data-content_root="../">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Forecasting Inflation with AutoML in Amazon SageMaker Autopilot - flaviagiammarino.com</title><link rel="shortcut icon" href="../_static/favicon.ico"/><link rel="index" title="Index" href="../genindex.html" /><link rel="prev" title="Zero-shot time series forecasting with Chronos using Amazon Bedrock and ClickHouse" href="chronos_bedrock.html" />
      <link rel="canonical" href="https://flaviagiammarino.com/blog/inflation_autopilot.html" /><script>
    function setColorMode(t){let e=document.documentElement;e.setAttribute("data-color-mode",t);let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s=t;"auto"===t&&(s=a?"dark":"light"),"light"===s?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))}
    setColorMode(localStorage._theme||"auto");
  </script><link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=397bb51e" />
    <link rel="stylesheet" type="text/css" href="../_static/shibuya.css?v=d48c410d" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link media="print" rel="stylesheet" type="text/css" href="../_static/print.css?v=20ff2c19" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --sy-f-text: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
  --sy-f-heading: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
}
</style>
    <meta name="description" content="Forecast US Inflation with AutoML in Amazon SageMaker Autopilot using the FRED-MD dataset">
  <meta name="thumbnail" content="https://machine-learning-blog.s3.eu-west-2.amazonaws.com/inflation_autopilot/architecture_diagram.png">
  <meta name="keywords" content="Time Series Forecasting, Inflation Forecasting, AutoML, Amazon SageMaker Autopilot, FRED-MD">
  <meta property="og:type" content="website"/>
<meta property="og:url" content="https://flaviagiammarino.com/blog/inflation_autopilot.html"/>
<meta property="og:title" content="Forecasting Inflation with AutoML in Amazon SageMaker Autopilot"/>
<meta name="twitter:card" content="summary"/>
  
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LPMJ6R8T4C"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LPMJ6R8T4C');
</script></head>
<body><div class="sy-head">
  <div class="sy-head-blur"></div>
  <div class="sy-head-inner sy-container mx-auto">
    <a class="sy-head-brand" href="../index.html">
      <img class="light-logo" src="../_static/icon-light.png" alt="" height="28" loading="lazy" />
      <img class="dark-logo" src="../_static/icon-dark.png" alt="" height="28" loading="lazy" />
      <strong></strong>
    </a>
    <div class="sy-head-nav" id="head-nav">
      <nav class="sy-head-links"></nav>
      <div class="sy-head-extra flex items-center print:hidden"><form class="searchbox flex items-center" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <kbd>/</kbd>
</form><div class="sy-head-socials"></div></div>
    </div>
    <div class="sy-head-actions flex items-center shrink-0 print:hidden"><button class="js-theme theme-switch flex items-center"
data-aria-auto="Switch to light color mode"
data-aria-light="Switch to dark color mode"
data-aria-dark="Switch to auto color mode">
<i class="i-lucide theme-icon"></i>
</button><button class="md:hidden flex items-center js-menu" aria-label="Menu" type="button" aria-controls="head-nav" aria-expanded="false">
        <div class="hamburger">
          <span class="hamburger_1"></span>
          <span class="hamburger_2 -translate-x-2"></span>
          <span class="hamburger_3 -translate-x-1"></span>
        </div>
      </button>
    </div>
  </div>
</div>
<div class="sy-page sy-container flex mx-auto">
    <aside id="lside" class="sy-lside md:w-72 md:shrink-0 print:hidden">
        <button class="rside-close js-menu xl:hidden" aria-label="Close left sidebar" type="button" aria-controls="lside" aria-expanded="false">
            <i class="i-lucide close"></i>
        </button>
        <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4">
<div class="ablog-sidebar-item ablog__categories">
  <h3 style="color: var(--sy-c-light);">
    <a href="category.html">Categories</a>
  </h3>
  <ul>
     
    <li>
      <a style="font-size: 90%" href="category/automl.html">AutoML (1)</a>
    </li>
      
    <li>
      <a style="font-size: 90%" href="category/time-series-foundation-models.html">Time Series Foundation Models (1)</a>
    </li>
     
  </ul>
</div>

<div class="ablog-sidebar-item ablog__tagcloud">
  <h3 style="color: var(--sy-c-light);">
      <a href="tag.html">Tags</a>
  </h3>
  <ul class="ablog-cloud">
     
    <li class="ablog-cloud ablog-cloud-1">
      <a style="font-size: 90%" href="tag/amazon-bedrock.html">Amazon Bedrock</a>
    </li>
      
    <li class="ablog-cloud ablog-cloud-1">
      <a style="font-size: 90%" href="tag/amazon-chronos.html">Amazon Chronos</a>
    </li>
      
    <li class="ablog-cloud ablog-cloud-1">
      <a style="font-size: 90%" href="tag/amazon-sagemaker.html">Amazon SageMaker</a>
    </li>
      
    <li class="ablog-cloud ablog-cloud-1">
      <a style="font-size: 90%" href="tag/large-language-models.html">Large Language Models</a>
    </li>
      
    <li class="ablog-cloud ablog-cloud-1">
      <a style="font-size: 90%" href="tag/machine-learning.html">Machine Learning</a>
    </li>
      
    <li class="ablog-cloud ablog-cloud-5">
      <a style="font-size: 90%" href="tag/time-series-forecasting.html">Time Series Forecasting</a>
    </li>
     
  </ul>
</div>

<div class="ablog-sidebar-item ablog__archives">
  <h3 style="color: var(--sy-c-light);">
    <a href="archive.html">Archives</a>
  </h3>
  <ul>
     
    <li>
      <a style="font-size: 90%" href="2025.html">2025 (2)</a>
    </li>
     
  </ul>
</div>
</div>
    </aside>

    <aside id="rside" class="sy-rside pb-3 w-64 shrink-0 order-last">
    <button class="rside-close js-menu xl:hidden" aria-label="Close right sidebar" type="button" aria-controls="rside" aria-expanded="false">
      <i class="i-lucide close"></i>
    </button>
    <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4"><div class="localtoc" style="font-size: 90%;">
            <h3 style="color: var(--sy-c-light);">
                On this page
            </h3>
            <ul>
<li><a class="reference internal" href="#overview">1. Overview</a><ul>
<li><a class="reference internal" href="#amazon-sagemaker-autopilot">1.1 Amazon SageMaker Autopilot</a></li>
<li><a class="reference internal" href="#fred-md-dataset">1.2 FRED-MD dataset</a></li>
</ul>
</li>
<li><a class="reference internal" href="#solution">2. Solution</a><ul>
<li><a class="reference internal" href="#set-up-the-environment">2.1 Set up the environment</a></li>
<li><a class="reference internal" href="#define-the-auxiliary-functions-for-working-with-the-fred-md-data">2.2 Define the auxiliary functions for working with the FRED-MD data</a></li>
<li><a class="reference internal" href="#prepare-the-fred-md-data-and-upload-it-to-s3">2.3 Prepare the FRED-MD data and upload it to S3</a></li>
<li><a class="reference internal" href="#configure-and-run-the-automl-job">2.4 Configure and run the AutoML job</a></li>
<li><a class="reference internal" href="#generate-the-automl-predictions">2.5 Generate the AutoML predictions</a></li>
<li><a class="reference internal" href="#evaluate-the-automl-prediction">2.6 Evaluate the AutoML prediction</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#appendix">Appendix</a></li>
</ul>

        </div></div>
  </aside>

  <main class="sy-main w-full max-sm:max-w-full print:pt-6">
<div class="sy-breadcrumbs" role="navigation">
  <div class="sy-breadcrumbs-inner flex items-center">
    <div class="md:hidden mr-3">
      <button class="js-menu" aria-label="Menu" type="button" aria-controls="lside" aria-expanded="false">
        <i class="i-lucide menu"></i>
      </button>
    </div>
    <ol class="flex-1" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../index.html"><span itemprop="name"></span></a>
        <span>/</span>
        <meta itemprop="position" content="1" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <strong itemprop="name">Forecasting Inflation with AutoML in Amazon SageMaker Autopilot</strong>
        <meta itemprop="position" content="2" />
      </li></ol>
    <div class="xl:hidden ml-1">
      <button class="js-menu" aria-label="Show table of contents" type="button" aria-controls="rside"
        aria-expanded="false">
        <i class="i-lucide outdent"></i>
      </button>
    </div>
  </div>
</div><div class="flex flex-col break-words justify-between">
      <div class="min-w-0 max-w-6xl px-6 pb-6 pt-8 xl:px-12">
        <article class="yue" role="main">
          <section id="forecasting-inflation-with-automl-in-amazon-sagemaker-autopilot">
<h1>Forecasting Inflation with AutoML in Amazon SageMaker Autopilot<a class="headerlink" href="#forecasting-inflation-with-automl-in-amazon-sagemaker-autopilot" title="Link to this heading">¶</a></h1>
<img
    src="https://machine-learning-blog.s3.eu-west-2.amazonaws.com/inflation_autopilot/architecture_diagram.png"
    style="width:100%"
    alt="Architecture diagram showing inflation forecasting with Amazon SageMaker Autopilot using data from FRED MD stored in Amazon S3"
><section id="overview">
<h2>1. Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>Automated Machine Learning (AutoML) frameworks address the expertise- and time-intensive nature of the traditional ML model development workflow.
By automating the end-to-end process of building, training and tuning ML models through easy-to-use programmatic interfaces,
AutoML solutions make ML accessible to non-specialists and significantly reduce deployment timeframes.</p>
<p>In this post, we demonstrate how to use Amazon SageMaker Autopilot <a class="reference external" href="#references">[1]</a>, AWS’s AutoML framework,
to forecast US inflation using the <a class="reference external" href="https://research.stlouisfed.org/econ/mccracken/fred-databases/">FRED-MD</a> dataset <a class="reference external" href="#references">[2]</a>.
FRED-MD is an open-source dataset maintained by the Federal Reserve Bank of St. Louis
including over 100 monthly time series of US macroeconomic indicators (see the <a class="reference internal" href="#appendix">Appendix</a> for the full list).
FRED-MD is widely used in economic research, and has become a standard benchmark for evaluating machine learning models
for US inflation forecasting (see, for instance, <a class="reference external" href="#references">[3]</a>, <a class="reference external" href="#references">[4]</a>, <a class="reference external" href="#references">[5]</a>).</p>
<p>In this demonstration, we use AutoML to forecast the month-on-month (MoM) US CPI inflation.
On each month, the model predicts the following month’s percentage change in the <a class="reference external" href="https://fred.stlouisfed.org/series/CPIAUCSL">US Consumer Price Index (CPI)</a>
using the current month’s FRED-MD indicators as inputs.
We first run an AutoML job on FRED-MD data from January 1960 to December 2023 to select the best ML pipeline.
We then use this ML pipeline in an Amazon SageMaker batch transform job to generate one-month-ahead forecasts from January 2024 to December 2024.</p>
<section id="amazon-sagemaker-autopilot">
<h3>1.1 Amazon SageMaker Autopilot<a class="headerlink" href="#amazon-sagemaker-autopilot" title="Link to this heading">¶</a></h3>
<p>Autopilot is a fully managed AutoML solution designed to automate the end-to-end ML pipeline
while maintaining transparency and flexibility.
Unlike traditional black-box AutoML systems, Autopilot provides a white-box approach,
allowing users to inspect and modify the generated ML pipelines to incorporate domain expertise when necessary <a class="reference external" href="#references">[1]</a>.</p>
<p>Given a tabular dataset and a specified target column, Autopilot generates a set of candidate ML pipelines optimized for the
given dataset’s characteristics and the specific problem type. Each candidate pipeline implements the end-to-end process of
data preparation, feature selection, algorithm training and hyperparameter tuning.
Autopilot then evaluates the candidate pipelines to produce a leaderboard and select the best-performing pipeline.</p>
<p>As part of this process, Autopilot automatically generates a set of data analysis and model insights reports in various formats,
along with Jupyter notebooks that allow users to examine and refine the pipelines without reverting to a fully manual approach.
Autopilot’s full integration with the broader SageMaker platform allows users to quickly deploy the final selected pipeline in production.</p>
</section>
<section id="fred-md-dataset">
<h3>1.2 FRED-MD dataset<a class="headerlink" href="#fred-md-dataset" title="Link to this heading">¶</a></h3>
<p>FRED-MD is a publicly available dataset of U.S. macroeconomic indicators maintained by the Federal Reserve Bank of St. Louis.
The FRED-MD dataset was introduced to provide a common benchmark for comparing model performance and to facilitate the
reproducibility of research results <a class="reference external" href="#references">[2]</a>.</p>
<p>The FRED-MD dataset is updated on a monthly basis, with each monthly release referred to as <em>vintage</em>.
The vintages are published on the <a class="reference external" href="https://research.stlouisfed.org/econ/mccracken/fred-databases/">FRED-MD website</a> in CSV format.
Each vintage includes monthly data from January 1959 up to the month prior to the release.
For instance, the January 2024 vintage includes the data from January 1959 to December 2023.
Different vintages can include different time series, as indicators are occasionally added and removed from the dataset.</p>
<p>The FRED-MD time series are sourced from the
<a class="reference external" href="href=&quot;https://fred.stlouisfed.org/">Federal Reserve Economic Data (FRED) database</a>,
which is St. Louis Fed’s main, publicly accessible, economic database.
Different retrospective adjustments are applied to the time series sourced from the FRED database,
including seasonal adjustments, inflation adjustments and backfilling of missing values.
As a result, different vintages can report different values for the same time series on the same month.</p>
<p>The FRED-MD dataset has been used extensively for forecasting US inflation.
In <a class="reference external" href="#references">[3]</a> it was shown that a random forest model trained on the FRED-MD dataset outperforms several
standard inflation forecasting models at different forecasting horizons.
<a class="reference external" href="#references">[4]</a> applied different dimension reduction techniques to the FRED-MD dataset to forecast
US inflation and found that autoencoders provide the best performance.
<a class="reference external" href="#references">[5]</a> expanded the analysis in <a class="reference external" href="#references">[3]</a> to include an LSTM model and found that it did
not significantly outperform the random forest model.</p>
</section>
</section>
<section id="solution">
<h2>2. Solution<a class="headerlink" href="#solution" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To be able to run the code provided in this section, you will need to launch an Amazon SageMaker notebook instance.
You will also need to download the CSV files with the FRED-MD data from the <a class="reference external" href="https://research.stlouisfed.org/econ/mccracken/fred-databases/">FRED-MD website</a>
and store them in a local folder.</p>
</div>
<section id="set-up-the-environment">
<h3>2.1 Set up the environment<a class="headerlink" href="#set-up-the-environment" title="Link to this heading">¶</a></h3>
<p>We start by importing all the dependencies and setting up the Amazon SageMaker environment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Import the dependencies</span>
</span><span data-line="2"><span class="kn">import</span><span class="w"> </span><span class="nn">io</span>
</span><span data-line="3"><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
</span><span data-line="4"><span class="kn">import</span><span class="w"> </span><span class="nn">sagemaker</span>
</span><span data-line="5"><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span data-line="6"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span data-line="7"><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span data-line="8"><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">root_mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
</span><span data-line="9">
</span><span data-line="10"><span class="c1"># Get the SageMaker session</span>
</span><span data-line="11"><span class="n">session</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Get the SageMaker execution role</span>
</span><span data-line="14"><span class="n">role</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">get_execution_role</span><span class="p">()</span>
</span><span data-line="15">
</span><span data-line="16"><span class="c1"># Get the default S3 bucket</span>
</span><span data-line="17"><span class="n">bucket</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">default_bucket</span><span class="p">()</span>
</span></pre></div>
</div>
</section>
<section id="define-the-auxiliary-functions-for-working-with-the-fred-md-data">
<h3>2.2 Define the auxiliary functions for working with the FRED-MD data<a class="headerlink" href="#define-the-auxiliary-functions-for-working-with-the-fred-md-data" title="Link to this heading">¶</a></h3>
<p>Next, we define a set of auxiliary functions for processing the FRED-MD data.</p>
<p>
<span style="font-weight:600">2.2.1</span>
<code class="docutils literal notranslate">
<span class="pre" style="font-weight:600">transform_series</span>
</code>
</p><p>The <code class="docutils literal notranslate"><span class="pre">transform_series</span></code> function transforms each FRED-MD time series according to the assigned transformation code.
The transformation code specifies which transformation the FRED-MD authors suggest applying to each time series in order to make it stationary.
The transformation codes are included in the first row of each CSV file and are defined as follows:</p>
<ol class="arabic simple">
<li><p>no transformation</p></li>
<li><p>first order difference</p></li>
<li><p>second order difference</p></li>
<li><p>logarithm</p></li>
<li><p>first order logarithmic difference</p></li>
<li><p>second order logarithmic difference</p></li>
<li><p>percentage change</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">transform_series</span><span class="p">(</span>
</span><span data-line="2">    <span class="n">x</span><span class="p">,</span>
</span><span data-line="3">    <span class="n">tcode</span>
</span><span data-line="4"><span class="p">):</span>
</span><span data-line="5"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="6"><span class="sd">    Transform the time series.</span>
</span><span data-line="7">
</span><span data-line="8"><span class="sd">    Parameters:</span>
</span><span data-line="9"><span class="sd">    ========================================================================================================</span>
</span><span data-line="10"><span class="sd">    x: pandas.Series</span>
</span><span data-line="11"><span class="sd">        Time series.</span>
</span><span data-line="12">
</span><span data-line="13"><span class="sd">    tcode: int.</span>
</span><span data-line="14"><span class="sd">        Transformation code.</span>
</span><span data-line="15"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="16">
</span><span data-line="17">    <span class="k">if</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span data-line="18">        <span class="c1"># No transformation</span>
</span><span data-line="19">        <span class="k">return</span> <span class="n">x</span>
</span><span data-line="20">
</span><span data-line="21">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span data-line="22">        <span class="c1"># First order absolute difference</span>
</span><span data-line="23">        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span data-line="24">
</span><span data-line="25">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span data-line="26">        <span class="c1"># Second order absolute difference</span>
</span><span data-line="27">        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span data-line="28">
</span><span data-line="29">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span data-line="30">        <span class="c1"># Logarithm</span>
</span><span data-line="31">        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span data-line="32">
</span><span data-line="33">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span data-line="34">        <span class="c1"># First order logarithmic difference</span>
</span><span data-line="35">        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span data-line="36">
</span><span data-line="37">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
</span><span data-line="38">        <span class="c1"># Second order logarithmic difference</span>
</span><span data-line="39">        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span data-line="40">
</span><span data-line="41">    <span class="k">elif</span> <span class="n">tcode</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
</span><span data-line="42">        <span class="c1"># Percentage change</span>
</span><span data-line="43">        <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">pct_change</span><span class="p">()</span>
</span><span data-line="44">
</span><span data-line="45">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="46">        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unknown `tcode` </span><span class="si">{</span><span class="n">tcode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
<p>
<span style="font-weight:600">2.2.2</span>
<code class="docutils literal notranslate">
<span class="pre" style="font-weight:600">get_data</span>
</code>
</p><p>The <code class="docutils literal notranslate"><span class="pre">get_data</span></code> function loads the data for a selected vintage from the
corresponding CSV file and prepares it for the model by transforming and lagging
the time series.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span>
</span><span data-line="2">    <span class="n">vintage</span><span class="p">,</span>
</span><span data-line="3">    <span class="n">series_names</span><span class="p">,</span>
</span><span data-line="4">    <span class="n">target_name</span><span class="p">,</span>
</span><span data-line="5">    <span class="n">target_tcode</span><span class="p">,</span>
</span><span data-line="6">    <span class="n">n_lags</span><span class="p">,</span>
</span><span data-line="7"><span class="p">):</span>
</span><span data-line="8"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="9"><span class="sd">    Get the data for a selected vintage.</span>
</span><span data-line="10">
</span><span data-line="11"><span class="sd">    Parameters:</span>
</span><span data-line="12"><span class="sd">    ========================================================================================================</span>
</span><span data-line="13"><span class="sd">    vintage: str.</span>
</span><span data-line="14"><span class="sd">        The vintage of the dataset, in &quot;YYYY-MM&quot; format.</span>
</span><span data-line="15">
</span><span data-line="16"><span class="sd">    series_names: str.</span>
</span><span data-line="17"><span class="sd">        The time series to be included in the dataset.</span>
</span><span data-line="18">
</span><span data-line="19"><span class="sd">    target_name: string.</span>
</span><span data-line="20"><span class="sd">        The name of the target time series.</span>
</span><span data-line="21">
</span><span data-line="22"><span class="sd">    target_tcode: int.</span>
</span><span data-line="23"><span class="sd">        The transformation code of the target time series.</span>
</span><span data-line="24">
</span><span data-line="25"><span class="sd">    n_lags: int.</span>
</span><span data-line="26"><span class="sd">        The number of autoregressive lags.</span>
</span><span data-line="27"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="28">    <span class="c1"># Get the file path</span>
</span><span data-line="29">    <span class="n">file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;data/</span><span class="si">{</span><span class="n">vintage</span><span class="si">}</span><span class="s2">.csv&quot;</span>
</span><span data-line="30">
</span><span data-line="31">    <span class="c1"># Get the time series</span>
</span><span data-line="32">    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)),</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="33">    <span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span data-line="34">    <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
</span><span data-line="35">    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">series_names</span><span class="p">]</span>
</span><span data-line="36">
</span><span data-line="37">    <span class="c1"># Get the transformation codes</span>
</span><span data-line="38">    <span class="n">tcodes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="39">    <span class="n">tcodes</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">tcodes</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
</span><span data-line="40">
</span><span data-line="41">    <span class="c1"># Override the target&#39;s transformation code</span>
</span><span data-line="42">    <span class="n">tcodes</span><span class="p">[</span><span class="n">target_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">target_tcode</span>
</span><span data-line="43">
</span><span data-line="44">    <span class="c1"># Transform the time series</span>
</span><span data-line="45">    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">transform_series</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tcodes</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()))</span>
</span><span data-line="46">
</span><span data-line="47">    <span class="c1"># Add the lags</span>
</span><span data-line="48">    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">target_name</span><span class="p">]]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n_lags</span><span class="p">)),</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;_LAG&quot;</span><span class="p">))</span>
</span><span data-line="49">
</span><span data-line="50">    <span class="c1"># Drop the missing values resulting from applying the transformations and taking the lags</span>
</span><span data-line="51">    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</span><span data-line="52">
</span><span data-line="53">    <span class="k">return</span> <span class="n">data</span>
</span></pre></div>
</div>
<p>
<span style="font-weight:600">2.2.3</span>
<code class="docutils literal notranslate">
<span class="pre" style="font-weight:600">get_common_series</span>
</code>
</p><p>To ensure consistent data across training, validation, and testing, we define a function that identifies
which indicators have complete time series across all consecutive vintages in our analysis period.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_common_series</span><span class="p">(</span>
</span><span data-line="2">    <span class="n">start_vintage</span><span class="p">,</span>
</span><span data-line="3">    <span class="n">end_vintage</span>
</span><span data-line="4"><span class="p">):</span>
</span><span data-line="5"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="6"><span class="sd">    Get the list of complete time series included in all dataset releases between two vintages.</span>
</span><span data-line="7">
</span><span data-line="8"><span class="sd">    Parameters:</span>
</span><span data-line="9"><span class="sd">    ========================================================================================================</span>
</span><span data-line="10"><span class="sd">    start_vintage: str.</span>
</span><span data-line="11"><span class="sd">        The first vintage, in &quot;YYYY-MM&quot; format.</span>
</span><span data-line="12">
</span><span data-line="13"><span class="sd">    end_vintage: str.</span>
</span><span data-line="14"><span class="sd">        The last vintage, in &quot;YYYY-MM&quot; format.</span>
</span><span data-line="15"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="16">    <span class="c1"># Generate the date range</span>
</span><span data-line="17">    <span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
</span><span data-line="18">        <span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">start_vintage</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">start_vintage</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
</span><span data-line="19">        <span class="n">end</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">end_vintage</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">end_vintage</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
</span><span data-line="20">        <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;MS&quot;</span>
</span><span data-line="21">    <span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23">    <span class="c1"># Create a list for storing the names of the complete time series</span>
</span><span data-line="24">    <span class="n">series</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="25">
</span><span data-line="26">    <span class="c1"># Loop across the dates</span>
</span><span data-line="27">    <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">dates</span><span class="p">:</span>
</span><span data-line="28">        <span class="c1"># Load the data for the considered date</span>
</span><span data-line="29">        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;data/</span><span class="si">{</span><span class="n">date</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="nb">format</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;02d&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)),</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="30">
</span><span data-line="31">        <span class="c1"># Drop the incomplete time series</span>
</span><span data-line="32">        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span data-line="33">
</span><span data-line="34">        <span class="c1"># Save the names of the complete time series</span>
</span><span data-line="35">        <span class="n">series</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
</span><span data-line="36">
</span><span data-line="37">    <span class="c1"># Get the list of complete time series included in the dataset on all dates</span>
</span><span data-line="38">    <span class="n">series</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="n">series</span><span class="p">)))</span>
</span><span data-line="39">
</span><span data-line="40">    <span class="k">return</span> <span class="n">series</span>
</span></pre></div>
</div>
<p>
<span style="font-weight:600">2.2.4</span>
<code class="docutils literal notranslate">
<span class="pre" style="font-weight:600">get_real_time_data</span>
</code>
</p><p>To address any potential data leakage, while replicating realistic model usage
where the model makes predictions on newly available data, we construct our
evaluation set using the last month from each consecutive vintage.</p>
<p>This approach is implemented in the <code class="docutils literal notranslate"><span class="pre">get_real_time_data</span></code> function, which processes
each vintage using the <code class="docutils literal notranslate"><span class="pre">get_data</span></code> function and concatenates the final month from
each vintage into a unique Pandas DataFrame.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="k">def</span><span class="w"> </span><span class="nf">get_real_time_data</span><span class="p">(</span>
</span><span data-line="2">    <span class="n">start_vintage</span><span class="p">,</span>
</span><span data-line="3">    <span class="n">end_vintage</span><span class="p">,</span>
</span><span data-line="4">    <span class="n">series_names</span><span class="p">,</span>
</span><span data-line="5">    <span class="n">target_name</span><span class="p">,</span>
</span><span data-line="6">    <span class="n">target_tcode</span><span class="p">,</span>
</span><span data-line="7">    <span class="n">n_lags</span><span class="p">,</span>
</span><span data-line="8"><span class="p">):</span>
</span><span data-line="9">
</span><span data-line="10"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="11"><span class="sd">    Get the real-time data between two vintages.</span>
</span><span data-line="12">
</span><span data-line="13"><span class="sd">    Parameters:</span>
</span><span data-line="14"><span class="sd">    ========================================================================================================</span>
</span><span data-line="15"><span class="sd">    start_vintage: str.</span>
</span><span data-line="16"><span class="sd">        The first vintage, in &quot;YYYY-MM&quot; format.</span>
</span><span data-line="17">
</span><span data-line="18"><span class="sd">    end_vintage: str.</span>
</span><span data-line="19"><span class="sd">        The last vintage, in &quot;YYYY-MM&quot; format.</span>
</span><span data-line="20">
</span><span data-line="21"><span class="sd">    series_names: str.</span>
</span><span data-line="22"><span class="sd">        The time series to be included in the dataset.</span>
</span><span data-line="23">
</span><span data-line="24"><span class="sd">    target_name: string.</span>
</span><span data-line="25"><span class="sd">        The name of the target time series.</span>
</span><span data-line="26">
</span><span data-line="27"><span class="sd">    target_tcode: int.</span>
</span><span data-line="28"><span class="sd">        The transformation code of the target time series.</span>
</span><span data-line="29">
</span><span data-line="30"><span class="sd">    n_lags: int.</span>
</span><span data-line="31"><span class="sd">        The number of autoregressive lags.</span>
</span><span data-line="32"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="33">
</span><span data-line="34">    <span class="c1"># Generate the date range</span>
</span><span data-line="35">    <span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
</span><span data-line="36">        <span class="n">start</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">start_vintage</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">start_vintage</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
</span><span data-line="37">        <span class="n">end</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">end_vintage</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">end_vintage</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">-01&quot;</span><span class="p">,</span>
</span><span data-line="38">        <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;MS&quot;</span>
</span><span data-line="39">    <span class="p">)</span>
</span><span data-line="40">
</span><span data-line="41">    <span class="c1"># Get the last month of data for each date in the considered range</span>
</span><span data-line="42">    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
</span><span data-line="43">        <span class="n">get_data</span><span class="p">(</span>
</span><span data-line="44">            <span class="n">vintage</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">date</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="nb">format</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;02d&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span data-line="45">            <span class="n">series_names</span><span class="o">=</span><span class="n">series_names</span><span class="p">,</span>
</span><span data-line="46">            <span class="n">target_name</span><span class="o">=</span><span class="n">target_name</span><span class="p">,</span>
</span><span data-line="47">            <span class="n">target_tcode</span><span class="o">=</span><span class="n">target_tcode</span><span class="p">,</span>
</span><span data-line="48">            <span class="n">n_lags</span><span class="o">=</span><span class="n">n_lags</span><span class="p">,</span>
</span><span data-line="49">        <span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
</span><span data-line="50">        <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">dates</span>
</span><span data-line="51">    <span class="p">])</span>
</span><span data-line="52">
</span><span data-line="53">    <span class="k">return</span> <span class="n">data</span>
</span></pre></div>
</div>
</section>
<section id="prepare-the-fred-md-data-and-upload-it-to-s3">
<h3>2.3 Prepare the FRED-MD data and upload it to S3<a class="headerlink" href="#prepare-the-fred-md-data-and-upload-it-to-s3" title="Link to this heading">¶</a></h3>
<p>We now use the functions defined in the previous section for processing the FRED-MD data.
We start by defining the target name, the target transformation code and the number of lags used for constructing the features.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We override the suggested transformation for the US CPI,
which is second order logarithmic difference (<code class="docutils literal notranslate"><span class="pre">tcode</span> <span class="pre">=</span> <span class="pre">6</span></code>),
as the resulting time series can’t be interpreted as an inflation rate.
We use percentage changes (<code class="docutils literal notranslate"><span class="pre">tcode</span> <span class="pre">=</span> <span class="pre">7</span></code>) insted, which results in a
MoM inflation rate time series.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Define the name of the target time series</span>
</span><span data-line="2"><span class="n">target_name</span> <span class="o">=</span> <span class="s2">&quot;CPIAUCSL&quot;</span>
</span><span data-line="3">
</span><span data-line="4"><span class="c1"># Define the transformation code of the target time series</span>
</span><span data-line="5"><span class="n">target_tcode</span> <span class="o">=</span> <span class="mi">7</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Define the number of autoregressive lags of each time series</span>
</span><span data-line="8"><span class="n">n_lags</span> <span class="o">=</span> <span class="mi">1</span>
</span></pre></div>
</div>
<p>After that, we extract the list of complete time series included in all vintages used for the analysis.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Get the list of complete time series included in all vintages from 2023-01 to 2025-01</span>
</span><span data-line="2"><span class="n">series_names</span> <span class="o">=</span> <span class="n">get_common_series</span><span class="p">(</span>
</span><span data-line="3">    <span class="n">start_vintage</span><span class="o">=</span><span class="s2">&quot;2023-01&quot;</span><span class="p">,</span>
</span><span data-line="4">    <span class="n">end_vintage</span><span class="o">=</span><span class="s2">&quot;2025-01&quot;</span><span class="p">,</span>
</span><span data-line="5"><span class="p">)</span>
</span></pre></div>
</div>
<p>This results in 101 time series, including the target time series.</p>
<p>
<span style="font-weight:600">2.3.1 Training data</span>
</p><p>For training the candidate models during the AutoML experiment, we use the data from January 1960 to December 2022.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Prepare the training data</span>
</span><span data-line="2"><span class="n">training_data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span>
</span><span data-line="3">    <span class="n">vintage</span><span class="o">=</span><span class="s2">&quot;2023-01&quot;</span><span class="p">,</span>
</span><span data-line="4">    <span class="n">series_names</span><span class="o">=</span><span class="n">series_names</span><span class="p">,</span>
</span><span data-line="5">    <span class="n">target_name</span><span class="o">=</span><span class="n">target_name</span><span class="p">,</span>
</span><span data-line="6">    <span class="n">target_tcode</span><span class="o">=</span><span class="n">target_tcode</span><span class="p">,</span>
</span><span data-line="7">    <span class="n">n_lags</span><span class="o">=</span><span class="n">n_lags</span><span class="p">,</span>
</span><span data-line="8"><span class="p">)</span>
</span><span data-line="9">
</span><span data-line="10"><span class="c1"># Upload the training data to S3</span>
</span><span data-line="11"><span class="n">training_data_s3_uri</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">upload_string_as_file_body</span><span class="p">(</span>
</span><span data-line="12">    <span class="n">body</span><span class="o">=</span><span class="n">training_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
</span><span data-line="13">    <span class="n">bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span>
</span><span data-line="14">    <span class="n">key</span><span class="o">=</span><span class="s2">&quot;data/train.csv&quot;</span>
</span><span data-line="15"><span class="p">)</span>
</span></pre></div>
</div>
<p>
<span style="font-weight:600">2.3.2 Validation data</span>
</p><p>For evaluating and ranking the candidate models during the AutoML experiment,
we use the data from January 2023 to December 2023, where the data for each month is
extracted separately from the corresponding vintage.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If the validation data is not provided, SageMaker Autopilot performs cross-validation on the training data.
However, the generated cross-validation splits may not preserve temporal order, resulting in potentially
training the model on future data and evaluating it on past data.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Prepare the validation data</span>
</span><span data-line="2"><span class="n">validation_data</span> <span class="o">=</span> <span class="n">get_real_time_data</span><span class="p">(</span>
</span><span data-line="3">    <span class="n">start_vintage</span><span class="o">=</span><span class="s2">&quot;2023-02&quot;</span><span class="p">,</span>
</span><span data-line="4">    <span class="n">end_vintage</span><span class="o">=</span><span class="s2">&quot;2024-01&quot;</span><span class="p">,</span>
</span><span data-line="5">    <span class="n">series_names</span><span class="o">=</span><span class="n">series_names</span><span class="p">,</span>
</span><span data-line="6">    <span class="n">target_name</span><span class="o">=</span><span class="n">target_name</span><span class="p">,</span>
</span><span data-line="7">    <span class="n">target_tcode</span><span class="o">=</span><span class="n">target_tcode</span><span class="p">,</span>
</span><span data-line="8">    <span class="n">n_lags</span><span class="o">=</span><span class="n">n_lags</span><span class="p">,</span>
</span><span data-line="9"><span class="p">)</span>
</span><span data-line="10">
</span><span data-line="11"><span class="c1"># Upload the validation data to S3</span>
</span><span data-line="12"><span class="n">validation_data_s3_uri</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">upload_string_as_file_body</span><span class="p">(</span>
</span><span data-line="13">    <span class="n">body</span><span class="o">=</span><span class="n">validation_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
</span><span data-line="14">    <span class="n">bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span>
</span><span data-line="15">    <span class="n">key</span><span class="o">=</span><span class="s2">&quot;data/valid.csv&quot;</span>
</span><span data-line="16"><span class="p">)</span>
</span></pre></div>
</div>
<p>
<span style="font-weight:600">2.3.3 Test data</span>
</p><p>For testing the best candidate model selected by the AutoML experiment,
we use the data from January 2024 to December 2024, where again the data
for each month is extracted separately from the corresponding vintage.
The testing is performed later by performing a batch transform job with
the best candidate model to generate the test set predictions.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Make sure to exclude the header and to drop the target column from the
test dataset before uploading it to S3, otherwise the batch transform job will fail.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Prepare the test data</span>
</span><span data-line="2"><span class="n">test_data</span> <span class="o">=</span> <span class="n">get_real_time_data</span><span class="p">(</span>
</span><span data-line="3">    <span class="n">start_vintage</span><span class="o">=</span><span class="s2">&quot;2024-02&quot;</span><span class="p">,</span>
</span><span data-line="4">    <span class="n">end_vintage</span><span class="o">=</span><span class="s2">&quot;2025-01&quot;</span><span class="p">,</span>
</span><span data-line="5">    <span class="n">series_names</span><span class="o">=</span><span class="n">series_names</span><span class="p">,</span>
</span><span data-line="6">    <span class="n">target_name</span><span class="o">=</span><span class="n">target_name</span><span class="p">,</span>
</span><span data-line="7">    <span class="n">target_tcode</span><span class="o">=</span><span class="n">target_tcode</span><span class="p">,</span>
</span><span data-line="8">    <span class="n">n_lags</span><span class="o">=</span><span class="n">n_lags</span><span class="p">,</span>
</span><span data-line="9"><span class="p">)</span>
</span><span data-line="10">
</span><span data-line="11"><span class="c1"># Upload the test data to S3</span>
</span><span data-line="12"><span class="n">test_data_s3_uri</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">upload_string_as_file_body</span><span class="p">(</span>
</span><span data-line="13">    <span class="n">body</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">target_name</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
</span><span data-line="14">    <span class="n">bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span>
</span><span data-line="15">    <span class="n">key</span><span class="o">=</span><span class="s2">&quot;data/test.csv&quot;</span>
</span><span data-line="16"><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="configure-and-run-the-automl-job">
<h3>2.4 Configure and run the AutoML job<a class="headerlink" href="#configure-and-run-the-automl-job" title="Link to this heading">¶</a></h3>
<p>We configure the AutoML experiment as a regression task, using mean squared error (MSE) as the validation objective to minimize.
The experiment is run in ensembling mode, so the final pipeline combines multiple algorithms rather than returning a single optimized model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Define the AutoML job configuration</span>
</span><span data-line="2"><span class="n">automl</span> <span class="o">=</span> <span class="n">sagemaker</span><span class="o">.</span><span class="n">automl</span><span class="o">.</span><span class="n">automlv2</span><span class="o">.</span><span class="n">AutoMLV2</span><span class="p">(</span>
</span><span data-line="3">    <span class="n">problem_config</span><span class="o">=</span><span class="n">sagemaker</span><span class="o">.</span><span class="n">automl</span><span class="o">.</span><span class="n">automlv2</span><span class="o">.</span><span class="n">AutoMLTabularConfig</span><span class="p">(</span>
</span><span data-line="4">        <span class="n">target_attribute_name</span><span class="o">=</span><span class="n">target_name</span><span class="p">,</span>
</span><span data-line="5">        <span class="n">algorithms_config</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;randomforest&quot;</span><span class="p">,</span> <span class="s2">&quot;extra-trees&quot;</span><span class="p">,</span> <span class="s2">&quot;xgboost&quot;</span><span class="p">,</span> <span class="s2">&quot;linear-learner&quot;</span><span class="p">,</span> <span class="s2">&quot;nn-torch&quot;</span><span class="p">],</span>
</span><span data-line="6">        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;ENSEMBLING&quot;</span><span class="p">,</span>
</span><span data-line="7">        <span class="n">problem_type</span><span class="o">=</span><span class="s2">&quot;Regression&quot;</span><span class="p">,</span>
</span><span data-line="8">    <span class="p">),</span>
</span><span data-line="9">    <span class="n">job_objective</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;MetricName&quot;</span><span class="p">:</span> <span class="s2">&quot;MSE&quot;</span><span class="p">},</span>
</span><span data-line="10">    <span class="n">base_job_name</span><span class="o">=</span><span class="s2">&quot;us-cpi&quot;</span><span class="p">,</span>
</span><span data-line="11">    <span class="n">output_path</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;s3://</span><span class="si">{</span><span class="n">bucket</span><span class="si">}</span><span class="s2">/output/&quot;</span><span class="p">,</span>
</span><span data-line="12">    <span class="n">role</span><span class="o">=</span><span class="n">role</span><span class="p">,</span>
</span><span data-line="13">    <span class="n">sagemaker_session</span><span class="o">=</span><span class="n">session</span><span class="p">,</span>
</span><span data-line="14"><span class="p">)</span>
</span><span data-line="15">
</span><span data-line="16"><span class="c1"># Run the AutoML job</span>
</span><span data-line="17"><span class="n">automl</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
</span><span data-line="18">    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="19">        <span class="n">sagemaker</span><span class="o">.</span><span class="n">automl</span><span class="o">.</span><span class="n">automlv2</span><span class="o">.</span><span class="n">AutoMLDataChannel</span><span class="p">(</span>
</span><span data-line="20">            <span class="n">s3_data_type</span><span class="o">=</span><span class="s2">&quot;S3Prefix&quot;</span><span class="p">,</span>
</span><span data-line="21">            <span class="n">s3_uri</span><span class="o">=</span><span class="n">training_data_s3_uri</span><span class="p">,</span>
</span><span data-line="22">            <span class="n">channel_type</span><span class="o">=</span><span class="s2">&quot;training&quot;</span><span class="p">,</span>
</span><span data-line="23">            <span class="n">compression_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span data-line="24">            <span class="n">content_type</span><span class="o">=</span><span class="s2">&quot;text/csv;header=present&quot;</span>
</span><span data-line="25">        <span class="p">),</span>
</span><span data-line="26">        <span class="n">sagemaker</span><span class="o">.</span><span class="n">automl</span><span class="o">.</span><span class="n">automlv2</span><span class="o">.</span><span class="n">AutoMLDataChannel</span><span class="p">(</span>
</span><span data-line="27">            <span class="n">s3_data_type</span><span class="o">=</span><span class="s2">&quot;S3Prefix&quot;</span><span class="p">,</span>
</span><span data-line="28">            <span class="n">s3_uri</span><span class="o">=</span><span class="n">validation_data_s3_uri</span><span class="p">,</span>
</span><span data-line="29">            <span class="n">channel_type</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
</span><span data-line="30">            <span class="n">compression_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span data-line="31">            <span class="n">content_type</span><span class="o">=</span><span class="s2">&quot;text/csv;header=present&quot;</span>
</span><span data-line="32">        <span class="p">),</span>
</span><span data-line="33">    <span class="p">]</span>
</span><span data-line="34"><span class="p">)</span>
</span></pre></div>
</div>
<p>After the AutoML job has completed, we can extract the S3 location containing
the model artifacts of the final selected pipeline.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Get the best model</span>
</span><span data-line="2"><span class="n">automl</span><span class="o">.</span><span class="n">best_candidate</span><span class="p">()</span>
</span></pre></div>
</div>
<p>The AutoML job automatically generates several reports for each candidate pipeline,
including a model explainability report with the feature importances and a model
quality report with an analysis of the performance on the validation data, which are also saved to S3.</p>
<p>
<span style="font-weight:600">2.4.1 Model explainability report</span>
</p><p>The model explainability report includes the feature importances calculated using the Kernel SHAP method.
The report shows that the previous month’s CPI inflation is the most influential predictor,
followed by the industrial production for residential utilities and the crude oil price.
Transportation inflation and producer prices for finished consumer goods are also important,
while factors such as initial unemployment claims, the AAA corporate bond spread,
and real money supply are also relevant, though less significant.</p>
<div style="margin: 2em 0em 2em 0em">

<img
    src="https://machine-learning-blog.s3.eu-west-2.amazonaws.com/inflation_autopilot/feature_importance_plot.png"
    style="width:100%"
    alt="Bar chart of top 10 features by SHAP value"
>

<p>
<span style="font-weight:600">Figure 1:</span>
<span>Top 10 features by SHAP value.</span>
</p>

</div><p>
<span style="font-weight:600">2.4.2 Model quality report</span>
</p><p>The model quality report includes the model’s performance metrics on the validation data as well as several diagnostic plots,
such as actual versus predicted scatter plots and standardized residuals plots.
The report shows that the model achieves a root mean squared error (RMSE) of 0.2073%,
a mean absolute error (MAE) of 0.1743% and a 60% R-squared on the validation data.</p>
<div style="margin: 2em 0em 2em 0em">

<img
    src="https://machine-learning-blog.s3.eu-west-2.amazonaws.com/inflation_autopilot/actual_vs_predicted_plot.png"
    style="width:100%"
    alt="Scatter plot of actual versus predicted US CPI MoM inflation from January 2023 to December 2023"
>

<p>
<span style="font-weight:600">Figure 2:</span>
<span>Actual versus predicted US CPI MoM inflation from January 2023 to December 2023.</span>
</p>

</div></section>
<section id="generate-the-automl-predictions">
<h3>2.5 Generate the AutoML predictions<a class="headerlink" href="#generate-the-automl-predictions" title="Link to this heading">¶</a></h3>
<p>We now run a batch transform job with the selected pipeline to generate the forecasts over the test set.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Create the model</span>
</span><span data-line="2"><span class="n">model</span> <span class="o">=</span> <span class="n">automl</span><span class="o">.</span><span class="n">create_model</span><span class="p">(</span>
</span><span data-line="3">    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;us-cpi-model&quot;</span><span class="p">,</span>
</span><span data-line="4">    <span class="n">sagemaker_session</span><span class="o">=</span><span class="n">session</span><span class="p">,</span>
</span><span data-line="5"><span class="p">)</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Create the transformer</span>
</span><span data-line="8"><span class="n">transformer</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transformer</span><span class="p">(</span>
</span><span data-line="9">    <span class="n">instance_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="10">    <span class="n">instance_type</span><span class="o">=</span><span class="s2">&quot;ml.m5.xlarge&quot;</span><span class="p">,</span>
</span><span data-line="11"><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Run the transform job</span>
</span><span data-line="14"><span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
</span><span data-line="15">    <span class="n">data</span><span class="o">=</span><span class="n">test_data_s3_uri</span><span class="p">,</span>
</span><span data-line="16">    <span class="n">content_type</span><span class="o">=</span><span class="s2">&quot;text/csv&quot;</span><span class="p">,</span>
</span><span data-line="17"><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="evaluate-the-automl-prediction">
<h3>2.6 Evaluate the AutoML prediction<a class="headerlink" href="#evaluate-the-automl-prediction" title="Link to this heading">¶</a></h3>
<p>After the batch transform job has completed, we can load the forecasts from S3.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Get the AutoML predictions from S3</span>
</span><span data-line="2"><span class="n">predictions</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">read_s3_file</span><span class="p">(</span>
</span><span data-line="3">    <span class="n">bucket</span><span class="o">=</span><span class="n">bucket</span><span class="p">,</span>
</span><span data-line="4">    <span class="n">key_prefix</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">transformer</span><span class="o">.</span><span class="n">latest_transform_job</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">/test.csv.out&quot;</span>
</span><span data-line="5"><span class="p">)</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Cast the predictions to data frame</span>
</span><span data-line="8"><span class="n">predictions</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">predictions</span><span class="p">),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span data-line="9"><span class="n">predictions</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">test_data</span><span class="o">.</span><span class="n">index</span>
</span><span data-line="10"><span class="n">predictions</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Forecast&quot;</span><span class="p">]</span>
</span><span data-line="11">
</span><span data-line="12"><span class="c1"># Add the actual values to the data frame</span>
</span><span data-line="13"><span class="n">predictions</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Actual&quot;</span><span class="p">,</span> <span class="n">test_data</span><span class="p">[</span><span class="n">target_name</span><span class="p">])</span>
</span></pre></div>
</div>
<div style="margin: 2em 0em 2em 0em">

<img
    src="https://machine-learning-blog.s3.eu-west-2.amazonaws.com/inflation_autopilot/forecasts_table.png"
    style="width:55%"
    alt="Table of 1-month-ahead AutoML forecasts of US CPI MoM inflation and historical FRED-MD data"
>

<p>
<span style="font-weight:600">Figure 3:</span>
<span>1-month-ahead AutoML forecasts of US CPI MoM inflation and historical FRED-MD data.</span>
</p>

</div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="c1"># Calculate the error metrics</span>
</span><span data-line="2"><span class="n">errors</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span data-line="3">    <span class="s2">&quot;RMSE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">format</span><span class="p">(</span><span class="n">root_mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;Actual&quot;</span><span class="p">],</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;Forecast&quot;</span><span class="p">]),</span> <span class="s2">&quot;.4%&quot;</span><span class="p">)],</span>
</span><span data-line="4">    <span class="s2">&quot;MAE&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">format</span><span class="p">(</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;Actual&quot;</span><span class="p">],</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;Forecast&quot;</span><span class="p">]),</span> <span class="s2">&quot;.4%&quot;</span><span class="p">)]</span>
</span><span data-line="5"><span class="p">})</span>
</span><span data-line="6">
</span><span data-line="7"><span class="c1"># Calculate the correlations between the predictions and the actual values</span>
</span><span data-line="8"><span class="n">correlations</span> <span class="o">=</span> <span class="n">predictions</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</span></pre></div>
</div>
<p>The RMSE is 0.1322% while the MAE is 0.0978%. The forecasts display a relatively high
correlation with the data (78% R-squared), even though some significant deviations
are observed on a few months.</p>
<div style="margin: 2em 0em 2em 0em">

<img
    src="https://machine-learning-blog.s3.eu-west-2.amazonaws.com/inflation_autopilot/forecasts_plot.png"
    style="width:100%"
    alt="Line chart of 1-month-ahead AutoML forecasts of US CPI MoM inflation against historical FRED-MD data from January 2024 to December 2024"
>

<p>
<span style="font-weight:600">Figure 4:</span>
<span>1-month-ahead AutoML forecasts of US CPI MoM inflation against historical FRED-MD data from January 2024 to December 2024.</span>
</p>

</div><p>You can download the Amazon SageMaker notebook with the full code from this post’s
<a class="reference external" href="https://github.com/flaviagiammarino/machine-learning-blog/blob/main/inflation_autopilot/amazon_sagemaker_notebook.ipynb">GitHub repository</a>.</p>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">¶</a></h2>
<p>[1] Das, P., Ivkin, N., Bansal, T., Rouesnel, L., Gautier, P., Karnin, Z., Dirac, L., Ramakrishnan, L., Perunicic, A., Shcherbatyi, I. and Wu, W., (2020).
Amazon SageMaker Autopilot: a white box AutoML solution at scale.
In <em>Proceedings of the Fourth International Workshop on Data Management for End-to-End Machine Learning</em>, 1-7.
<a class="reference external" href="https://doi.org/10.1145/3399579.3399870">doi: 10.1145/3399579.3399870</a>.</p>
<p>[2] McCracken, M. W., &amp; Ng, S. (2016). FRED-MD: A monthly database for macroeconomic research.
<em>Journal of Business &amp; Economic Statistics</em>, 34(4), 574-589.
<a class="reference external" href="https://doi.org/10.1080/07350015.2015.1086655">doi: 10.1080/07350015.2015.1086655</a>.</p>
<p>[3] Medeiros, M. C., Vasconcelos, G. F., Veiga, Á., &amp; Zilberman, E. (2021).
Forecasting inflation in a data-rich environment: the benefits of machine learning methods.
<em>Journal of Business &amp; Economic Statistics</em>, 39(1), 98-119.
<a class="reference external" href="https://doi.org/10.1080/07350015.2019.1637745">doi: 10.1080/07350015.2019.1637745</a>.</p>
<p>[4] Hauzenberger, N., Huber, F., &amp; Klieber, K. (2023). Real-time inflation forecasting using non-linear dimension reduction techniques.
<em>International Journal of Forecasting</em>, 39(2), 901-921.
<a class="reference external" href="https://doi.org/10.1016/j.ijforecast.2022.03.002">doi: 10.1016/j.ijforecast.2022.03.002</a>.</p>
<p>[5] Paranhos, L. (2025). Predicting Inflation with Recurrent Neural Networks.
<em>International Journal of Forecasting</em>, In press.
<a class="reference external" href="https://doi.org/10.1016/j.ijforecast.2024.07.010">doi: 10.1016/j.ijforecast.2024.07.010</a>.</p>
</section>
<section id="appendix">
<h2>Appendix<a class="headerlink" href="#appendix" title="Link to this heading">¶</a></h2>
<p><strong>Group 1: Output and Income.</strong></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CUMFNS</p></td>
<td><p>Capacity Utilization: Manufacturing</p></td>
</tr>
<tr class="row-odd"><td><p>INDPRO</p></td>
<td><p>IP: Index</p></td>
</tr>
<tr class="row-even"><td><p>IPBUSEQ</p></td>
<td><p>IP: Business Equipment</p></td>
</tr>
<tr class="row-odd"><td><p>IPCONGD</p></td>
<td><p>IP: Consumer Goods</p></td>
</tr>
<tr class="row-even"><td><p>IPDCONGD</p></td>
<td><p>IP: Durable Consumer Goods</p></td>
</tr>
<tr class="row-odd"><td><p>IPDMAT</p></td>
<td><p>IP: Durable Materials</p></td>
</tr>
<tr class="row-even"><td><p>IPFINAL</p></td>
<td><p>IP: Final Products (Market Group)</p></td>
</tr>
<tr class="row-odd"><td><p>IPFPNSS</p></td>
<td><p>IP: Final Products and Nonindustrial Supplies</p></td>
</tr>
<tr class="row-even"><td><p>IPFUELS</p></td>
<td><p>IP: Fuels</p></td>
</tr>
<tr class="row-odd"><td><p>IPMANSICS</p></td>
<td><p>IP: Manufacturing (SIC)</p></td>
</tr>
<tr class="row-even"><td><p>IPMAT</p></td>
<td><p>IP: Materials</p></td>
</tr>
<tr class="row-odd"><td><p>IPNCONGD</p></td>
<td><p>IP: Nondurable Consumer Goods</p></td>
</tr>
<tr class="row-even"><td><p>IPNMAT</p></td>
<td><p>IP: Nondurable Materials</p></td>
</tr>
<tr class="row-odd"><td><p>IPB51222S</p></td>
<td><p>IP: Residential Utilities</p></td>
</tr>
<tr class="row-even"><td><p>RPI</p></td>
<td><p>Real Personal Income</p></td>
</tr>
<tr class="row-odd"><td><p>W875RX1</p></td>
<td><p>Real personal Income ex Transfer Receipts</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Group 2: Labor Market.</strong></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>USCONS</p></td>
<td><p>All Employees: Construction</p></td>
</tr>
<tr class="row-odd"><td><p>DMANEMP</p></td>
<td><p>All Employees: Durable goods</p></td>
</tr>
<tr class="row-even"><td><p>USFIRE</p></td>
<td><p>All Employees: Financial Activities</p></td>
</tr>
<tr class="row-odd"><td><p>USGOOD</p></td>
<td><p>All Employees: Goods-Producing Industries</p></td>
</tr>
<tr class="row-even"><td><p>USGOVT</p></td>
<td><p>All Employees: Government</p></td>
</tr>
<tr class="row-odd"><td><p>MANEMP</p></td>
<td><p>All Employees: Manufacturing</p></td>
</tr>
<tr class="row-even"><td><p>CES1021000001</p></td>
<td><p>All Employees: Mining and Logging:  Mining</p></td>
</tr>
<tr class="row-odd"><td><p>NDMANEMP</p></td>
<td><p>All Employees: Nondurable goods</p></td>
</tr>
<tr class="row-even"><td><p>USTRADE</p></td>
<td><p>All Employees: Retail Trade</p></td>
</tr>
<tr class="row-odd"><td><p>SRVPRD</p></td>
<td><p>All Employees: Service-Providing Industries</p></td>
</tr>
<tr class="row-even"><td><p>PAYEMS</p></td>
<td><p>All Employees: Total nonfarm</p></td>
</tr>
<tr class="row-odd"><td><p>USTPU</p></td>
<td><p>All Employees: Trade, Transportation &amp; Utilities</p></td>
</tr>
<tr class="row-even"><td><p>USWTRADE</p></td>
<td><p>All Employees: Wholesale Trade</p></td>
</tr>
<tr class="row-odd"><td><p>UEMPMEAN</p></td>
<td><p>Average Duration of Unemployment (Weeks)</p></td>
</tr>
<tr class="row-even"><td><p>CES2000000008</p></td>
<td><p>Average Hourly Earnings: Construction</p></td>
</tr>
<tr class="row-odd"><td><p>CES0600000008</p></td>
<td><p>Average Hourly Earnings: Goods-Producing</p></td>
</tr>
<tr class="row-even"><td><p>CES3000000008</p></td>
<td><p>Average Hourly Earnings: Manufacturing</p></td>
</tr>
<tr class="row-odd"><td><p>CES0600000007</p></td>
<td><p>Average Weekly Hours: Goods-Producing</p></td>
</tr>
<tr class="row-even"><td><p>AWHMAN</p></td>
<td><p>Average Weekly Hours: Manufacturing</p></td>
</tr>
<tr class="row-odd"><td><p>AWOTMAN</p></td>
<td><p>Average Weekly Overtime Hours: Manufacturing</p></td>
</tr>
<tr class="row-even"><td><p>CE16OV</p></td>
<td><p>Civilian Employment</p></td>
</tr>
<tr class="row-odd"><td><p>CLF16OV</p></td>
<td><p>Civilian Labor Force</p></td>
</tr>
<tr class="row-even"><td><p>UNRATE</p></td>
<td><p>Civilian Unemployment Rate</p></td>
</tr>
<tr class="row-odd"><td><p>UEMP15OV</p></td>
<td><p>Civilians Unemployed - 15 Weeks &amp; Over</p></td>
</tr>
<tr class="row-even"><td><p>UEMPLT5</p></td>
<td><p>Civilians Unemployed - Less Than 5 Weeks</p></td>
</tr>
<tr class="row-odd"><td><p>UEMP15T26</p></td>
<td><p>Civilians Unemployed for 15-26 Weeks</p></td>
</tr>
<tr class="row-even"><td><p>UEMP27OV</p></td>
<td><p>Civilians Unemployed for 27 Weeks and Over</p></td>
</tr>
<tr class="row-odd"><td><p>UEMP5TO14</p></td>
<td><p>Civilians Unemployed for 5-14 Weeks</p></td>
</tr>
<tr class="row-even"><td><p>HWI</p></td>
<td><p>Help-Wanted Index for United States</p></td>
</tr>
<tr class="row-odd"><td><p>CLAIMSX</p></td>
<td><p>Initial Claims</p></td>
</tr>
<tr class="row-even"><td><p>HWIURATIO</p></td>
<td><p>Ratio of Help Wanted/No. Unemployed</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Group 3: Consumption and Orders.</strong></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>HOUSTMW</p></td>
<td><p>Housing Starts, Midwest</p></td>
</tr>
<tr class="row-odd"><td><p>HOUSTNE</p></td>
<td><p>Housing Starts, Northeast</p></td>
</tr>
<tr class="row-even"><td><p>HOUSTS</p></td>
<td><p>Housing Starts, South</p></td>
</tr>
<tr class="row-odd"><td><p>HOUSTW</p></td>
<td><p>Housing Starts, West</p></td>
</tr>
<tr class="row-even"><td><p>HOUST</p></td>
<td><p>Housing Starts: Total New Privately Owned</p></td>
</tr>
<tr class="row-odd"><td><p>PERMIT</p></td>
<td><p>New Private Housing Permits (SAAR)</p></td>
</tr>
<tr class="row-even"><td><p>PERMITMW</p></td>
<td><p>New Private Housing Permits, Midwest (SAAR)</p></td>
</tr>
<tr class="row-odd"><td><p>PERMITNE</p></td>
<td><p>New Private Housing Permits, Northeast (SAAR)</p></td>
</tr>
<tr class="row-even"><td><p>PERMITS</p></td>
<td><p>New Private Housing Permits, South (SAAR)</p></td>
</tr>
<tr class="row-odd"><td><p>PERMITW</p></td>
<td><p>New Private Housing Permits, West (SAAR)</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Group 4: Orders and Inventories.</strong></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>UMCSENTX</p></td>
<td><p>Consumer Sentiment Index</p></td>
</tr>
<tr class="row-odd"><td><p>ACOGNO</p></td>
<td><p>New Orders for Consumer Goods</p></td>
</tr>
<tr class="row-even"><td><p>AMDMNOX</p></td>
<td><p>New Orders for Durable Goods</p></td>
</tr>
<tr class="row-odd"><td><p>ANDENOX</p></td>
<td><p>New Orders for Nondefense Capital Goods</p></td>
</tr>
<tr class="row-even"><td><p>CMRMTSPLX</p></td>
<td><p>Real Manufacturing and Trade Industries Sales</p></td>
</tr>
<tr class="row-odd"><td><p>DPCERA3M086SBEA</p></td>
<td><p>Real Personal Consumption Expenditures</p></td>
</tr>
<tr class="row-even"><td><p>RETAILX</p></td>
<td><p>Retail and Food Services Sales</p></td>
</tr>
<tr class="row-odd"><td><p>BUSINVX</p></td>
<td><p>Total Business Inventories</p></td>
</tr>
<tr class="row-even"><td><p>ISRATIOX</p></td>
<td><p>Total Business: Inventories to Sales Ratio</p></td>
</tr>
<tr class="row-odd"><td><p>AMDMUOX</p></td>
<td><p>Unfilled Orders for Durable Goods</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Group 5: Money and Credit</strong></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BUSLOANS</p></td>
<td><p>Commercial and Industrial Loans</p></td>
</tr>
<tr class="row-odd"><td><p>DTCOLNVHFNM</p></td>
<td><p>Consumer Motor Vehicle Loans Outstanding</p></td>
</tr>
<tr class="row-even"><td><p>M1SL</p></td>
<td><p>M1 Money Stock</p></td>
</tr>
<tr class="row-odd"><td><p>M2SL</p></td>
<td><p>M2 Money Stock</p></td>
</tr>
<tr class="row-even"><td><p>BOGMBASE</p></td>
<td><p>Monetary Base</p></td>
</tr>
<tr class="row-odd"><td><p>CONSPI</p></td>
<td><p>Nonrevolving Consumer Credit to Personal Income</p></td>
</tr>
<tr class="row-even"><td><p>REALLN</p></td>
<td><p>Real Estate Loans at All Commercial Banks</p></td>
</tr>
<tr class="row-odd"><td><p>M2REAL</p></td>
<td><p>Real M2 Money Stock</p></td>
</tr>
<tr class="row-even"><td><p>NONBORRES</p></td>
<td><p>Reserves Of Depository Institutions</p></td>
</tr>
<tr class="row-odd"><td><p>INVEST</p></td>
<td><p>Securities in Bank Credit at All Commercial Banks</p></td>
</tr>
<tr class="row-even"><td><p>DTCTHFNM</p></td>
<td><p>Total Consumer Loans and Leases Outstanding</p></td>
</tr>
<tr class="row-odd"><td><p>NONREVSL</p></td>
<td><p>Total Nonrevolving Credit</p></td>
</tr>
<tr class="row-even"><td><p>TOTRESNS</p></td>
<td><p>Total Reserves of Depository Institutions</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Group 6: Interest Rates and Exchange Rates</strong></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>T1YFFM</p></td>
<td><p>1-Year Treasury C Minus FEDFUNDS</p></td>
</tr>
<tr class="row-odd"><td><p>GS1</p></td>
<td><p>1-Year Treasury Rate</p></td>
</tr>
<tr class="row-even"><td><p>T10YFFM</p></td>
<td><p>10-Year Treasury C Minus FEDFUNDS</p></td>
</tr>
<tr class="row-odd"><td><p>GS10</p></td>
<td><p>10-Year Treasury Rate</p></td>
</tr>
<tr class="row-even"><td><p>CP3MX</p></td>
<td><p>3-Month AA Financial Commercial Paper Rate</p></td>
</tr>
<tr class="row-odd"><td><p>COMPAPFFX</p></td>
<td><p>3-Month Commercial Paper Minus FEDFUNDS</p></td>
</tr>
<tr class="row-even"><td><p>TB3MS</p></td>
<td><p>3-Month Treasury Bill</p></td>
</tr>
<tr class="row-odd"><td><p>TB3SMFFM</p></td>
<td><p>3-Month Treasury C Minus FEDFUNDS</p></td>
</tr>
<tr class="row-even"><td><p>T5YFFM</p></td>
<td><p>5-Year Treasury C Minus FEDFUNDS</p></td>
</tr>
<tr class="row-odd"><td><p>GS5</p></td>
<td><p>5-Year Treasury Rate</p></td>
</tr>
<tr class="row-even"><td><p>TB6MS</p></td>
<td><p>6-Month Treasury Bill</p></td>
</tr>
<tr class="row-odd"><td><p>TB6SMFFM</p></td>
<td><p>6-Month Treasury C Minus FEDFUNDS</p></td>
</tr>
<tr class="row-even"><td><p>EXCAUSX</p></td>
<td><p>Canada / U.S. Foreign Exchange Rate</p></td>
</tr>
<tr class="row-odd"><td><p>FEDFUNDS</p></td>
<td><p>Effective Federal Funds Rate</p></td>
</tr>
<tr class="row-even"><td><p>EXJPUSX</p></td>
<td><p>Japan / U.S. Foreign Exchange Rate</p></td>
</tr>
<tr class="row-odd"><td><p>BAAFFM</p></td>
<td><p>Moody’s Baa Corporate Bond Minus FEDFUNDS</p></td>
</tr>
<tr class="row-even"><td><p>AAAFFM</p></td>
<td><p>Moody’s Aaa Corporate Bond Minus FEDFUNDS</p></td>
</tr>
<tr class="row-odd"><td><p>AAA</p></td>
<td><p>Moody’s Seasoned Aaa Corporate Bond Yield</p></td>
</tr>
<tr class="row-even"><td><p>BAA</p></td>
<td><p>Moody’s Seasoned Baa Corporate Bond Yield</p></td>
</tr>
<tr class="row-odd"><td><p>EXSZUSX</p></td>
<td><p>Switzerland / U.S. Foreign Exchange Rate</p></td>
</tr>
<tr class="row-even"><td><p>TWEXAFEGSMTHX</p></td>
<td><p>Trade Weighted U.S. Dollar Index</p></td>
</tr>
<tr class="row-odd"><td><p>EXUSUKX</p></td>
<td><p>U.S. / U.K. Foreign Exchange Rate</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Group 7: Prices</strong></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CPIAUCSL</p></td>
<td><p>CPI: All Items</p></td>
</tr>
<tr class="row-odd"><td><p>CPIULFSL</p></td>
<td><p>CPI: All Items less food</p></td>
</tr>
<tr class="row-even"><td><p>CUSR0000SA0L5</p></td>
<td><p>CPI: All items less medical care</p></td>
</tr>
<tr class="row-odd"><td><p>CUSR0000SA0L2</p></td>
<td><p>CPI: All items less shelter</p></td>
</tr>
<tr class="row-even"><td><p>CPIAPPSL</p></td>
<td><p>CPI: Apparel</p></td>
</tr>
<tr class="row-odd"><td><p>CUSR0000SAC</p></td>
<td><p>CPI: Commodities</p></td>
</tr>
<tr class="row-even"><td><p>CUSR0000SAD</p></td>
<td><p>CPI: Durables</p></td>
</tr>
<tr class="row-odd"><td><p>CPIMEDSL</p></td>
<td><p>CPI: Medical Care</p></td>
</tr>
<tr class="row-even"><td><p>CUSR0000SAS</p></td>
<td><p>CPI: Services</p></td>
</tr>
<tr class="row-odd"><td><p>CPITRNSL</p></td>
<td><p>CPI: Transportation</p></td>
</tr>
<tr class="row-even"><td><p>OILPRICEX</p></td>
<td><p>Crude Oil, Spliced WTI and Cushing</p></td>
</tr>
<tr class="row-odd"><td><p>WPSID62</p></td>
<td><p>PPI: Crude Materials</p></td>
</tr>
<tr class="row-even"><td><p>WPSFD49502</p></td>
<td><p>PPI: Finished Consumer Goods</p></td>
</tr>
<tr class="row-odd"><td><p>WPSFD49207</p></td>
<td><p>PPI: Finished Goods</p></td>
</tr>
<tr class="row-even"><td><p>WPSID61</p></td>
<td><p>PPI: Intermediate Materials</p></td>
</tr>
<tr class="row-odd"><td><p>PPICMM</p></td>
<td><p>PPI: Metals and metal products</p></td>
</tr>
<tr class="row-even"><td><p>DDURRG3M086SBEA</p></td>
<td><p>Personal Consumption Expenditures: Durable goods</p></td>
</tr>
<tr class="row-odd"><td><p>DNDGRG3M086SBEA</p></td>
<td><p>Personal Consumption Expenditures: Nondurable goods</p></td>
</tr>
<tr class="row-even"><td><p>DSERRG3M086SBEA</p></td>
<td><p>Personal Consumption Expenditures: Services</p></td>
</tr>
<tr class="row-odd"><td><p>PCEPI</p></td>
<td><p>Personal Consumption Expenditures: Chain Index</p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Group 8: Stock Market</strong></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>S&amp;P 500</p></td>
<td><p>S&amp;Ps Common Stock Price Index: Composite</p></td>
</tr>
<tr class="row-odd"><td><p>S&amp;P: INDUST</p></td>
<td><p>S&amp;Ps Common Stock Price Index: Industrials</p></td>
</tr>
<tr class="row-even"><td><p>S&amp;P DIV YIELD</p></td>
<td><p>S&amp;Ps Composite Common Stock: Dividend Yield</p></td>
</tr>
<tr class="row-odd"><td><p>S&amp;P PE RATIO</p></td>
<td><p>S&amp;Ps Composite Common Stock: Price-Earnings Ratio</p></td>
</tr>
<tr class="row-even"><td><p>VIXCLSX</p></td>
<td><p>VIX</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>

        </article><button class="back-to-top" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
  </svg>
  <span>Back to top</span>
</button><div class="navigation flex print:hidden"><div class="navigation-prev">
    <a href="chronos_bedrock.html">
      <i class="i-lucide chevron-left"></i>
      <div class="page-info">
        <span>Previous</span><div class="title">Zero-shot time series forecasting with Chronos using Amazon Bedrock and ClickHouse</div></div>
    </a>
  </div></div></div>
    </div>
  </main>

</div>
<footer class="sy-foot">
  <div class="sy-foot-inner sy-container mx-auto">
    <div class="sy-foot-reserved md:flex justify-between items-center">
      <div class="sy-foot-copyright"><p>Copyright © 2025, Flavia Giammarino.</p>
  
  <p>
    Made with
    
    <a href="https://www.sphinx-doc.org/">Sphinx</a> and
    
    <a href="https://shibuya.lepture.com">Shibuya theme</a>.
  </p>
</div>
      <div class="sy-foot-socials"></div>
    </div>
  </div>
</footer>
      <script src="../_static/documentation_options.js?v=73411916"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/shibuya.js?v=e730760c"></script>
      <script src="../_static/custom.js"></script></body>
</html>